<nav class="bg-white shadow-md fixed w-full z-20 top-0 left-0">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-20">
      <div class="flex items-center">
        <a href="{{ url_for('index') }}" class="group transition-transform duration-300 hover:scale-105">
          <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="Vextro Logo" class="h-20 w-auto mr-6 transition-transform duration-300 group-hover:scale-110">
        </a>
      </div>
      <div class="hidden md:flex items-center space-x-10">
        <a href="{{ url_for('index') }}" class="nav-link-attractive {% if request.path == '/' %}active{% endif %}">Home</a>
        <a href="{{ url_for('about') }}" class="nav-link-attractive {% if request.path == '/about' %}active{% endif %}">About</a>
        <div class="relative group">
          <a href="{{ url_for('products') }}" class="nav-link-attractive {% if 'products' in request.path %}active{% endif %} flex items-center gap-2">
            Products
            <svg class="w-4 h-4 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </a>
          <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 bg-gradient-to-br from-teal-50 via-white to-green-50 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform group-hover:translate-y-0 translate-y-4 dropdown-animate">
            <a href="{{ url_for('products', category='aldrops') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Aldrops</a>
            <a href="{{ url_for('products', category='glass brackets') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Glass Brackets</a>
            <a href="{{ url_for('products', category='glass holder') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Glass Holder</a>
            <a href="{{ url_for('products', category='hinges') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Hinges</a>
            <a href="{{ url_for('products', category='towerbolt') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Towerbolt</a>
            <a href="{{ url_for('products', category='miscellaneous') }}" class="block px-4 py-3 text-[#008000] hover:text-[#00C4B4] transition-colors duration-200">Miscellaneous</a>
          </div>
        </div>
        <a href="{{ url_for('contact') }}" class="nav-link-attractive {% if request.path == '/contact' %}active{% endif %}">Contact</a>
        <!-- <a href="#" id="download-catalog-btn" class="nav-link-attractive download-catalog-unique">Download Catelog</a> -->
      </div>
      <div class="md:hidden flex items-center">
        <button id="mobile-menu-button" class="text-[#00C4B4] focus:outline-none">
          <svg class="h-10 w-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
  <div id="mobile-menu" class="md:hidden hidden bg-white/80 backdrop-blur-md shadow-lg">
    <a href="{{ url_for('index') }}" class="block px-4 py-4 nav-link-attractive {% if request.path == '/' %}active{% endif %}">Home</a>
    <a href="{{ url_for('about') }}" class="block px-4 py-4 nav-link-attractive {% if request.path == '/about' %}active{% endif %}">About</a>
    <div class="relative group">
      <a href="{{ url_for('products') }}" class="block px-4 py-4 nav-link-attractive {% if 'products' in request.path %}active{% endif %}">Products</a>
       <div class="mt-2 space-y-2 pl-8">
            <a href="{{ url_for('products', category='aldrops') }}" class="block text-[#008000] hover:text-[#00C4B4]">Aldrops</a>
            <a href="{{ url_for('products', category='glass brackets') }}" class="block text-[#008000] hover:text-[#00C4B4]">Glass Brackets</a>
            <a href="{{ url_for('products', category='glass holder') }}" class="block text-[#008000] hover:text-[#00C4B4]">Glass Holder</a>
            <a href="{{ url_for('products', category='hinges') }}" class="block text-[#008000] hover:text-[#00C4B4]">Hinges</a>
            <a href="{{ url_for('products', category='towerbolt') }}" class="block text-[#008000] hover:text-[#00C4B4]">Towerbolt</a>
            <a href="{{ url_for('products', category='miscellaneous') }}" class="block text-[#008000] hover:text-[#00C4B4]">Miscellaneous</a>
        </div>
    </div>
    <a href="{{ url_for('contact') }}" class="block px-4 py-4 nav-link-attractive {% if request.path == '/contact' %}active{% endif %}">Contact</a>
    <!-- <a href="#" id="download-catalog-btn-mobile" class="block px-4 py-4 nav-link-attractive">Download Catelog</a> -->
  </div>
</nav>
<!-- Buffer Loader -->
<div id="buffer-loader" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
  <div class="loader-container flex flex-col items-center justify-center">
    <div class="loader-logo mb-2">
      <img src="{{ url_for('static', filename='assets/logo.png') }}" alt="Vextro Logo" class="w-24 h-24 md:w-32 md:h-32 max-w-xs mx-auto">
    </div>
    <div class="loader-dots flex space-x-2 mt-2 justify-center">
      <div class="dot w-4 h-4 rounded-full bg-[#00C4B4] animate-bounce"></div>
      <div class="dot w-4 h-4 rounded-full bg-[#008000] animate-bounce delay-150"></div>
      <div class="dot w-4 h-4 rounded-full bg-[#00C4B4] animate-bounce delay-300"></div>
    </div>
  </div>
</div>
<style>
  #buffer-loader { transition: opacity 0.4s; }
  .loader-logo img { max-width: 8rem; width: 6rem; height: auto; }
  .loader-dots .dot { animation-duration: 1s; animation-iteration-count: infinite; }
  @media (max-width: 640px) {
    .loader-logo img { max-width: 5rem; width: 4rem; }
    .loader-dots .dot { width: 1rem; height: 1rem; }
  }
  /* Unique style for Download Catelog (desktop menu only) */
  .download-catalog-unique {
    background: linear-gradient(90deg, #00C4B4 0%, #008000 100%);
    color: #fff !important;
    font-weight: bold;
    border-radius: 9999px;
    box-shadow: 0 2px 8px rgba(0,196,180,0.15);
    padding: 0.5rem 1.5rem;
    transition: box-shadow 0.2s, transform 0.2s, background 0.2s;
    border: none;
    outline: none;
    margin-left: 0.5rem;
  }
  .download-catalog-unique:hover, .download-catalog-unique:focus {
    background: linear-gradient(90deg, #008000 0%, #00C4B4 100%);
    box-shadow: 0 4px 16px rgba(0,196,180,0.25);
    transform: translateY(-2px) scale(1.04);
    color: #fff !important;
    text-decoration: none;
  }
</style>
<script>
  window.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      document.getElementById('buffer-loader').style.opacity = 0;
      setTimeout(function() {
        document.getElementById('buffer-loader').style.display = 'none';
      }, 400);
    }, 600); // Adjust delay as needed
  });
</script>
<div class="h-20"></div> <!-- Spacer for fixed nav --> 
<!-- Catalog Download Modal -->
<div id="catalog-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6 relative">
    <button id="close-catalog-modal" class="absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
    <h2 class="text-2xl font-bold mb-4 text-center text-[#008000]">Download Catelog</h2>
    <form id="catalog-download-form" class="space-y-4">
      <div>
        <label for="catalog-name" class="block text-gray-700">Name</label>
        <input type="text" id="catalog-name" name="name" class="w-full border rounded px-3 py-2" required>
      </div>
      <div>
        <label for="catalog-phone" class="block text-gray-700">Phone Number</label>
        <input type="tel" id="catalog-phone" name="phone" class="w-full border rounded px-3 py-2" required pattern="[0-9]{10,15}">
      </div>
      <button type="submit" id="catalog-download-btn" class="w-full bg-[#00C4B4] text-white py-2 rounded disabled:opacity-50" disabled>Download</button>
      <div id="catalog-form-message" class="text-center text-sm mt-2"></div>
    </form>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
  // Modal logic
  const modal = document.getElementById('catalog-modal');
  const openBtns = [document.getElementById('download-catalog-btn'), document.getElementById('download-catalog-btn-mobile')];
  const closeBtn = document.getElementById('close-catalog-modal');
  openBtns.forEach(btn => btn && btn.addEventListener('click', e => { e.preventDefault(); modal.classList.remove('hidden'); }));
  closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
  window.addEventListener('click', e => { if (e.target === modal) modal.classList.add('hidden'); });

  // Form logic
  const form = document.getElementById('catalog-download-form');
  const nameInput = document.getElementById('catalog-name');
  const phoneInput = document.getElementById('catalog-phone');
  const downloadBtn = document.getElementById('catalog-download-btn');
  const msgDiv = document.getElementById('catalog-form-message');

  function validateForm() {
    downloadBtn.disabled = !(nameInput.value.trim() && phoneInput.value.trim().match(/^[0-9]{10,15}$/));
  }
  nameInput.addEventListener('input', validateForm);
  phoneInput.addEventListener('input', validateForm);

  // EmailJS config (replace with your EmailJS user/service/template IDs)
  emailjs.init('MzqQDD5jsc2L0JWpv'); // <-- Replace with your EmailJS user ID

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    downloadBtn.disabled = true;
    msgDiv.textContent = 'Processing...';
    const name = nameInput.value.trim();
    const phone = phoneInput.value.trim();
    // 1. Send SMS via backend
    fetch('/api/catalog_download', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, phone })
    })
    .then(res => res.json())
    .then(data => {
      if (!data.success) throw new Error(data.error || 'SMS failed');
      // 2. Send Email via EmailJS
      return emailjs.send('service_vjkcoi5', 'template_54701de', { name, phone }); // <-- Replace with your IDs
    })
    .then(() => {
      msgDiv.textContent = 'Thank you! Your download will start.';
      // 3. Download the catalog
      setTimeout(() => {
        window.location.href = "/static/Resume.pdf"; // Updated to use the actual file
        modal.classList.add('hidden');
        form.reset();
        downloadBtn.disabled = true;
      }, 1000);
    })
    .catch(err => {
      msgDiv.textContent = 'Error: ' + err.message;
      downloadBtn.disabled = false;
    });
  });
</script> 